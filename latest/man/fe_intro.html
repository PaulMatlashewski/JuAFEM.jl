<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Introduction to FEM · JuAFEM.jl</title><link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/4.2.0/normalize.min.css" rel="stylesheet" type="text/css"/><link href="https://fonts.googleapis.com/css?family=Lato|Ubuntu+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.2.0/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link href="../assets/highlightjs/default.css" rel="stylesheet" type="text/css"/><link href="../assets/documenter.css" rel="stylesheet" type="text/css"/></head><body><nav class="toc"><h1>JuAFEM.jl</h1><select id="version-selector" onChange="window.location.href=this.value" style="visibility: hidden"></select><form class="search" action="../search.html"><input id="search-query" name="q" type="text" placeholder="Search docs"/></form><ul><li><a class="toctext" href="../index.html">Home</a></li><li class="current"><a class="toctext" href="fe_intro.html">Introduction to FEM</a><ul class="internal"><li><a class="toctext" href="#Strong-format-1">Strong format</a></li><li><a class="toctext" href="#Weak-format-1">Weak format</a></li><li><a class="toctext" href="#FE-approximation-1">FE-approximation</a></li><li><a class="toctext" href="#Implementation-in-JuAFEM-1">Implementation in JuAFEM</a></li></ul></li><li><a class="toctext" href="getting_started.html">Getting started</a></li><li><span class="toctext">Library</span><ul><li><a class="toctext" href="../lib/maintypes.html">Main Types</a></li><li><a class="toctext" href="../lib/utility_functions.html">Utilities</a></li></ul></li><li><a class="toctext" href="examples.html">Examples</a></li></ul></nav><article id="docs"><header><nav><ul><li><a href="fe_intro.html">Introduction to FEM</a></li></ul><a class="edit-page" href="https://github.com/KristofferC/JuAFEM.jl/tree/a9d261337bbc5ac38084ce1ff0fe8647d6cc1bbc/docs/src/man/fe_intro.md"><span class="fa"></span> Edit on GitHub</a></nav><hr/></header><h1><a class="nav-anchor" id="Introduction-to-FEM-1" href="#Introduction-to-FEM-1">Introduction to FEM</a></h1><p>Here, a very brief introduction to the finite element method is given, for reference. As an illustrative example we use balance of momentum, with a linear elastic material.</p><h2><a class="nav-anchor" id="Strong-format-1" href="#Strong-format-1">Strong format</a></h2><p>The strong format of balance of momentum can be written as:</p><div>\[-\mathbf{\sigma}\cdot \mathbf{\nabla} = \mathbf{f}\]</div><p>where <span>$\mathbf{\sigma}$</span> is the stress tensor and <span>$\mathbf{f}$</span> is the internal force (body force). To complete the system of equations we need boundary conditions. These are normally given as known displacements <span>$\mathbf{u}^\text{p}$</span> or known traction <span>$\mathbf{t}^\text{p}$</span> on different parts of the boundary. The stress can, using the linear elastic material model, be written as</p><div>\[\mathbf{\sigma} = \mathbf{\mathsf{C}} : \mathbf{\varepsilon}(\mathbf{u}) = \mathbf{\mathsf{C}} : [\mathbf{u} \otimes \mathbf{\nabla}]^{\text{sym}}\]</div><p>where <span>$\mathbf{\mathsf{C}}$</span> is the 4th order elasticity tensor and <span>$\mathbf{\varepsilon}(\mathbf{u})$</span> the symmetric part of the gradient of the displacement field <span>$\mathbf{u}$</span>.</p><h2><a class="nav-anchor" id="Weak-format-1" href="#Weak-format-1">Weak format</a></h2><p>The solution of the equation above is usually calculated from the corresponding weak format. By multiplying the equation with an arbitrary test function <span>$\mathbf{\delta u}$</span>, integrating over the domain and using partial integration the following equation is obtained; Find <span>$\mathbf{u} \in \mathbb{U}$</span> s.t.</p><div>\[\int_\Omega \mathbf{\varepsilon}(\mathbf{\delta u}) : \mathbf{\mathsf{C}} : \mathbf{\varepsilon}(\mathbf{u}) \text{d}\Omega = 
\int_\Gamma \mathbf{\delta u} \cdot \mathbf{t}^\text{p} \text{d}\Gamma +
\int_\Omega \mathbf{\delta u} \cdot \mathbf{f} \text{d}\Omega \qquad \forall \mathbf{\delta u} \in \mathbb{U}^0\]</div><p>where <span>$\mathbb{U}, \mathbb{U}^0$</span> are function spaces with sufficiently regular functions. The solution to this equation is identical to the one of the strong format.</p><h2><a class="nav-anchor" id="FE-approximation-1" href="#FE-approximation-1">FE-approximation</a></h2><p>Introduce the finite element approximation <span>$\mathbf{u}_h$</span> (e.g. <span>$\mathbf{u} \approx \mathbf{u}_\text{h}$</span>) as a sum of shape functions, <span>$\mathbf{N}_i$</span> and nodal values, <span>$a_i$</span></p><div>\[\mathbf{u}_\text{h} = \sum_{i=1}^{\text{N}} \mathbf{N}_i a_i,\qquad \delta\mathbf{u}_\text{h} = \sum_{i=1}^{\text{N}} \mathbf{N}_i \delta a_i\]</div><p>This approximation can be inserted in the weak format, which gives</p><div>\[\sum_i^N\sum_j^N \delta a_i \int_\Omega \mathbf{\varepsilon}(\mathbf{N}_i) : \mathbf{\mathsf{C}} : \mathbf{\varepsilon}(\mathbf{N}_j) \text{d}\Omega a_j = 
\sum_i^N \delta a_i \int_\Gamma \mathbf{N}_i \cdot \mathbf{t}^\text{p} \text{d}\Gamma +
\sum_i^N \delta a_i \int_\Omega \mathbf{N}_i \cdot \mathbf{f} \text{d}\Omega\]</div><p>Since <span>$\mathbf{\delta u}$</span> is arbitrary, the nodal values <span>$\delta a_i$</span> are arbitrary. Thus, the equation can be written as</p><div>\[\underline{K}\ \underline{a} = \underline{f}\]</div><p>where <span>$\underline{K}$</span> is the stiffness matrix, <span>$\underline{a}$</span> is the solution vector with the nodal values and <span>$\underline{f}$</span> is the force vector. The elements of <span>$\underline{K}$</span> and <span>$\underline{f}$</span> are given by</p><div>\[\underline{K}_{ij} = \int_\Omega \mathbf{\varepsilon}(\mathbf{N}_i) : \mathbf{\mathsf{C}} : \mathbf{\varepsilon}(\mathbf{N}_j) \text{d}\Omega\]</div><div>\[\underline{f}_{i} = \int_\Gamma \mathbf{N}_i \cdot \mathbf{t}^\text{p} \text{d}\Gamma +
                     \int_\Omega \mathbf{N}_i \cdot \mathbf{f} \text{d}\Omega\]</div><p>The solution to the system (which in this case is linear) is simply given by inverting the matrix <span>$\underline{K}$</span> and using the boundary conditions (prescribed displacements)</p><div>\[\underline{a} = \underline{K}^{-1}\ \underline{f}\]</div><h2><a class="nav-anchor" id="Implementation-in-JuAFEM-1" href="#Implementation-in-JuAFEM-1">Implementation in JuAFEM</a></h2><p>In practice, the shape functions <span>$\mathbf{N}$</span> are only non-zero on parts of the domain <span>$\Omega$</span>. Thus, the integrals are evaluated on sub-domains, called elements or cells. All the cells gives a contribution to the global stiffness matrix and force vector.</p><p>The integrals are evaluated using quadrature. In JuAFEM the stiffness matrix and force vector can be calculated like this</p><pre><code class="language-julia">...

for qp in 1:Nqp
    for i in 1:N
        f[i] += (shape_value(i) ⋅ f) * dΩ
        for j in 1:N
            K[i,j] += (shape_symmetric_gradient(i) : C : shape_symmetric_gradient(j)) * dΩ
        end
    end
end

...</code></pre><p>Although this is a simplification of the actual code, note the similarity between the code and the mathematical expression above.</p><footer><hr/><a class="previous" href="../index.html"><span class="direction">Previous</span><span class="title">Home</span></a><a class="next" href="getting_started.html"><span class="direction">Next</span><span class="title">Getting started</span></a></footer></article></body></html>
